{"version":3,"file":"index.js","sources":["../src/constants.ts","../src/utils.ts","../src/index.tsx"],"sourcesContent":["// GitHub theme\nimport { Theme } from 'react-activity-calendar';\n\nexport const API_URL = 'https://github-contributions-api.jogruber.de/v4/';\n\nexport const DEFAULT_THEME: Theme = {\n  level4: '#216e39',\n  level3: '#30a14e',\n  level2: '#40c463',\n  level1: '#9be9a8',\n  level0: '#ebedf0',\n};\n","import { CalendarData } from 'react-activity-calendar';\n\nimport { Props } from './index';\n\nexport const transformData = (\n  data: CalendarData,\n  transformFn?: Props['transformData'],\n): CalendarData => {\n  if (typeof transformFn !== 'function') {\n    return data;\n  }\n\n  const transformedData = transformFn(data);\n\n  if (!Array.isArray(transformedData)) {\n    throw new Error(`Passed function transformData must return a list of Day objects.`);\n  }\n\n  if (transformedData.length > 0) {\n    const testObj = transformedData[0];\n\n    if (typeof testObj.count !== 'number' || testObj.count < 0) {\n      throw new Error(\n        `Required property \"count: number\" missing or invalid. Got: ${testObj.count}`,\n      );\n    }\n\n    if (typeof testObj.date !== 'string' || !/(\\d{4})-(\\d{2})-(\\d{2})/.test(testObj.date)) {\n      throw new Error(\n        `Required property \"date: YYYY-MM-DD\" missing or invalid. Got: ${testObj.date}`,\n      );\n    }\n\n    if (typeof testObj.level !== 'number' || testObj.level < 0 || testObj.level > 4) {\n      throw new Error(\n        `Required property \"level: 0 | 1 | 2 | 3 | 4\" missing or invalid: Got: ${testObj.level}.`,\n      );\n    }\n  }\n\n  return transformedData;\n};\n","import React, { FunctionComponent, useCallback, useEffect, useState } from 'react';\nimport Calendar, {\n  CalendarData,\n  createCalendarTheme,\n  Props as CalendarProps,\n  Skeleton,\n} from 'react-activity-calendar';\n\nimport { API_URL, DEFAULT_THEME } from './constants';\nimport { ApiErrorResponse, ApiResponse, Year } from './types';\nimport { transformData } from './utils';\n\nexport interface Props extends Omit<CalendarProps, 'data'> {\n  username: string;\n  year?: Year;\n  transformData?: (data: CalendarData) => CalendarData;\n}\n\nasync function fetchCalendarData(username: string, year: Year): Promise<ApiResponse> {\n  const response = await fetch(`${API_URL}${username}?y=${year}`);\n  const data: ApiResponse | ApiErrorResponse = await response.json();\n\n  if (!response.ok) {\n    throw new Error((data as ApiErrorResponse).error);\n  }\n\n  return data as ApiResponse;\n}\n\nconst GitHubCalendar: FunctionComponent<Props> = ({\n  username,\n  year = 'last',\n  transformData: transformDataProp,\n  ...props\n}) => {\n  const [data, setData] = useState<CalendarData | null>(null);\n  const [loading, setLoading] = useState<boolean>(false);\n  const [error, setError] = useState<Error | null>(null);\n\n  const transformDataCallback = useCallback(\n    (contributions: CalendarData) => transformData(contributions, transformDataProp),\n    [transformDataProp],\n  );\n\n  const fetchData = useCallback(() => {\n    setLoading(true);\n    setError(null);\n    fetchCalendarData(username, year)\n      .then(({ contributions }) => setData(transformDataCallback(contributions)))\n      .catch(setError)\n      .finally(() => setLoading(false));\n  }, [username, year, transformDataCallback]);\n\n  useEffect(fetchData, [fetchData]);\n\n  if (error) {\n    return (\n      <div>\n        <i>Unable to fetch contribution data. See console.</i>\n      </div>\n    );\n  }\n\n  if (loading || !data) {\n    return <Skeleton {...props} loading />;\n  }\n\n  const theme = props.color ? undefined : props.theme ?? DEFAULT_THEME;\n\n  const labels = {\n    totalCount: `{{count}} contributions in ${year === 'last' ? 'the last year' : '{{year}}'}`,\n  };\n\n  return <Calendar data={data} theme={theme} labels={labels} {...props} />;\n};\n\nexport { createCalendarTheme };\nexport default GitHubCalendar;\n"],"names":["API_URL","DEFAULT_THEME","level4","level3","level2","level1","level0","transformData","data","transformFn","transformedData","Array","isArray","Error","length","testObj","count","date","test","level","fetchCalendarData","username","year","response","fetch","json","ok","error","GitHubCalendar","transformDataProp","props","setData","useState","loading","setLoading","setError","transformDataCallback","useCallback","contributions","fetchData","then","catch","finally","useEffect","React","Skeleton","theme","color","undefined","labels","totalCount","Calendar"],"mappings":"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"}